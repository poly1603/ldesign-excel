# Excel Viewer 浏览器测试清单

## 📋 测试准备

### 1. 确认服务已启动

在访问测试页面前，请确认所有开发服务器正在运行：

```bash
# 在浏览器地址栏检查以下地址是否可访问
✓ http://localhost:3000 - Vanilla JS
✓ http://localhost:3001 - Vue 3
✓ http://localhost:3002 - React
✓ http://localhost:3003 - Lit
```

### 2. 准备测试文件

准备一个简单的 Excel 测试文件：
- 文件格式：.xlsx
- 大小：< 1MB
- 内容：简单的表格数据（如姓名、年龄、地址等）

## ✅ 测试步骤

### Test 1: Vanilla JS 示例 (localhost:3000)

#### 基础测试

1. **打开页面**
   - [ ] 页面成功加载
   - [ ] 标题显示："📊 Excel Viewer - 原生 JavaScript 示例"
   - [ ] 页面布局正常，无明显错乱

2. **检查 UI 元素**
   - [ ] "选择 Excel 文件" 按钮显示
   - [ ] "加载示例文件" 按钮显示
   - [ ] "导出 Excel" 按钮显示
   - [ ] "导出 CSV" 按钮显示
   - [ ] "导出截图" 按钮显示
   - [ ] 搜索输入框显示
   - [ ] "搜索" 按钮显示
   - [ ] Excel 查看器容器显示（白色背景框）
   - [ ] 状态栏显示："等待加载文件..."

3. **控制台检查**
   - 按 F12 打开开发者工具
   - 切换到 Console 标签
   - [ ] 检查是否显示："✅ 查看器初始化成功"
   - [ ] 检查是否有红色错误信息
   - **记录所有错误信息**：
     ```
     错误信息：
     
     
     
     ```

4. **Luckysheet 检查**
   - 在控制台输入：`console.log(typeof window.luckysheet)`
   - [ ] 输出应该是 "object" 或 "function"
   - 如果是 "undefined"，记录问题

5. **文件上传测试**
   - [ ] 点击"选择 Excel 文件"按钮
   - [ ] 文件选择对话框打开
   - [ ] 选择一个 .xlsx 文件
   - [ ] 观察状态栏变化
   - [ ] 观察 Excel 查看器区域
   - [ ] 检查控制台是否有错误

6. **预期结果**
   - 如果一切正常：
     - [ ] 状态栏显示："✅ 成功加载 X 个工作表"
     - [ ] Excel 内容在查看器中正确显示
     - [ ] 可以看到单元格数据
   
   - 如果有问题：
     - **记录具体表现**：
       ```
       问题描述：
       
       
       
       ```

---

### Test 2: Vue 3 示例 (localhost:3001)

#### 基础测试

1. **打开页面**
   - [ ] 页面成功加载
   - [ ] 标题显示："📊 Excel Viewer - Vue 3 示例"
   - [ ] 页面布局正常

2. **检查 UI 元素**
   - [ ] 所有按钮和输入框显示正常
   - [ ] 状态栏显示："等待加载文件..."

3. **控制台检查**
   - [ ] 无 Vue 相关错误
   - [ ] 无组件加载错误
   - **记录所有错误**：
     ```
     错误信息：
     
     
     
     ```

4. **Vue 组件检查**
   - 打开 Vue Devtools（如果已安装）
   - [ ] 检查组件树是否正常
   - [ ] 检查 ExcelViewer 组件是否已挂载

5. **文件上传测试**
   - [ ] 点击"选择 Excel 文件"
   - [ ] 选择文件后观察
   - [ ] 检查状态变化
   - [ ] 检查 Excel 内容是否显示

6. **响应式测试**
   - [ ] 尝试点击其他按钮
   - [ ] 观察状态栏的响应式更新
   - [ ] 尝试输入搜索关键词

---

### Test 3: React 示例 (localhost:3002)

#### 基础测试

1. **打开页面**
   - [ ] 页面成功加载
   - [ ] 标题显示："📊 Excel Viewer - React 示例"
   - [ ] 页面布局正常

2. **检查 UI 元素**
   - [ ] 所有按钮和输入框显示正常
   - [ ] 状态栏显示："等待加载文件..."

3. **控制台检查**
   - [ ] 无 React 相关错误
   - [ ] 无组件渲染错误
   - **记录所有错误**：
     ```
     错误信息：
     
     
     
     ```

4. **React DevTools 检查**
   - 打开 React DevTools（如果已安装）
   - [ ] 检查组件树
   - [ ] 检查 ExcelViewer 组件状态

5. **文件上传测试**
   - [ ] 点击"选择 Excel 文件"
   - [ ] 选择文件后观察
   - [ ] 检查状态变化
   - [ ] 检查 Excel 内容是否显示

---

### Test 4: Lit 示例 (localhost:3003)

#### 基础测试

1. **打开页面**
   - [ ] 页面成功加载
   - [ ] 标题显示："📊 Excel Viewer - Lit Web Component 示例"
   - [ ] 页面布局正常

2. **检查 UI 元素**
   - [ ] 所有按钮和输入框显示正常
   - [ ] 状态栏显示："等待加载文件..."

3. **控制台检查**
   - [ ] 无 Web Component 相关错误
   - [ ] 无自定义元素错误
   - **记录所有错误**：
     ```
     错误信息：
     
     
     
     ```

4. **Web Component 检查**
   - 在控制台输入：
     ```javascript
     const viewer = document.querySelector('excel-viewer');
     console.log(viewer);
     ```
   - [ ] 应该输出 excel-viewer 元素
   - [ ] 检查元素属性是否正确

5. **文件上传测试**
   - [ ] 点击"选择 Excel 文件"
   - [ ] 选择文件后观察
   - [ ] 检查状态变化
   - [ ] 检查 Excel 内容是否显示

---

## 🐛 常见问题和解决方案

### 问题 1：页面空白或样式错乱

**可能原因**：
- Vite 开发服务器未启动
- CSS 未正确加载
- Luckysheet CSS 未加载

**检查步骤**：
1. 刷新页面
2. 检查 Network 面板，确认所有资源已加载
3. 查看控制台错误信息

### 问题 2：无法选择文件

**可能原因**：
- JavaScript 未加载
- 事件监听器未绑定

**检查步骤**：
1. 检查控制台是否有 JavaScript 错误
2. 确认 main.js 已加载

### 问题 3：选择文件后无反应

**可能原因**：
- Luckysheet 未加载
- xlsx 库未找到
- 数据转换错误

**检查步骤**：
1. 检查控制台错误信息
2. 验证 `window.luckysheet` 是否存在
3. 查看 Network 面板是否有 404 错误

### 问题 4：Excel 内容显示为空

**可能原因**：
- 文件解析失败
- 数据格式转换错误
- Luckysheet 初始化失败

**检查步骤**：
1. 尝试不同的 Excel 文件
2. 检查控制台详细错误信息
3. 查看源码中的数据转换逻辑

---

## 📊 测试结果汇总

### 整体评分

| 示例项目 | 页面加载 | UI显示 | 文件选择 | Excel渲染 | 总分 |
|---------|---------|--------|---------|-----------|------|
| Vanilla | ☐ | ☐ | ☐ | ☐ | __/4 |
| Vue | ☐ | ☐ | ☐ | ☐ | __/4 |
| React | ☐ | ☐ | ☐ | ☐ | __/4 |
| Lit | ☐ | ☐ | ☐ | ☐ | __/4 |

### 详细问题记录

#### Vanilla JS 问题

```
问题1：


问题2：


```

#### Vue 问题

```
问题1：


问题2：


```

#### React 问题

```
问题1：


问题2：


```

#### Lit 问题

```
问题1：


问题2：


```

---

## 📸 测试截图

建议截图保存：
1. 每个示例的初始页面
2. 选择文件后的页面
3. 任何错误提示
4. 控制台错误信息

---

## ✅ 测试结论

**测试日期**：__________  
**测试人员**：__________

**总体评价**：

☐ 优秀 - 所有功能正常
☐ 良好 - 大部分功能正常，有小问题
☐ 一般 - 部分功能正常，有明显问题
☐ 较差 - 大部分功能无法使用

**主要问题**：

1. 
2. 
3. 

**建议**：

1. 
2. 
3. 

---

**注意**：请在浏览器中实际测试后填写此清单！


