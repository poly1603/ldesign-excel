# 🚀 Excel Viewer 项目启动和测试指南

## 📍 您在这里

所有示例项目已经启动并运行！请按照以下步骤验证功能。

## ✅ 快速验证步骤

### 步骤 1：在浏览器中打开示例页面

请在浏览器中依次打开以下地址：

```
✓ Vanilla JS: http://localhost:3000
✓ Vue 3:      http://localhost:3001
✓ React:      http://localhost:3002
✓ Lit:        http://localhost:3003
```

### 步骤 2：验证页面是否正常显示

每个页面都应该显示：

1. **页面标题** - "📊 Excel Viewer - XXX 示例"
2. **工具栏按钮**：
   - 📁 选择 Excel 文件
   - 📄 加载示例文件
   - 💾 导出 Excel
   - 📋 导出 CSV
   - 📸 导出截图
   - 🔍 搜索按钮
3. **Excel 查看器区域** - 白色背景的大框
4. **状态栏** - 显示"等待加载文件..."

**如果页面显示正常 ✅** - 继续下一步  
**如果页面有问题 ❌** - 查看下方的问题排查部分

### 步骤 3：检查浏览器控制台

1. **按 F12** 打开开发者工具
2. **切换到 Console 标签**
3. **查找以下信息**：

#### Vanilla JS 示例应该显示：
```
✅ 查看器初始化成功
```

#### Vue/React/Lit 示例：
- 应该没有红色错误信息
- 可能有一些警告（黄色），这是正常的

**如果有大量红色错误** ❌ - 记录错误信息，查看问题排查部分

### 步骤 4：测试 Luckysheet 是否加载

在浏览器控制台输入以下命令并按回车：

```javascript
console.log(typeof window.luckysheet);
```

**预期结果**：应该输出 `"object"` 或 `"function"`

**如果输出 `"undefined"`** ❌ - Luckysheet 未正确加载

### 步骤 5：准备测试 Excel 文件

准备一个简单的 Excel 文件用于测试：

**选项 A：使用现有文件**
- 找一个简单的 .xlsx 或 .xls 文件
- 文件大小建议 < 1MB
- 内容简单即可

**选项 B：创建新文件**
1. 打开 Excel 或 WPS
2. 创建一个简单表格：
   ```
   姓名    年龄    城市
   张三    25     北京
   李四    30     上海
   王五    28     广州
   ```
3. 保存为 .xlsx 格式

### 步骤 6：上传测试文件

1. **点击** "📁 选择 Excel 文件" 按钮
2. **选择** 您准备的测试文件
3. **观察** 状态栏变化
4. **观察** Excel 查看器区域

#### 预期结果：

**✅ 成功的表现：**
- 状态栏显示："✅ 成功加载 1 个工作表"（或相应数量）
- Excel 查看器区域显示表格内容
- 可以看到单元格数据
- 数据显示正确

**⚠️ 可能的问题：**

1. **状态栏显示错误信息**
   ```
   ❌ 加载失败: XXX
   ```
   - 检查控制台的详细错误信息
   - 尝试其他 Excel 文件

2. **没有任何反应**
   - 检查控制台是否有错误
   - 确认文件选择对话框是否正常打开

3. **Excel 查看器区域是空白的**
   - 可能是 Luckysheet 初始化问题
   - 可能是数据转换问题
   - 检查控制台错误

## 🐛 问题排查

### 问题 1：页面无法打开

**症状**：浏览器显示"无法访问此网站"或"连接被拒绝"

**解决方案**：

1. 检查开发服务器是否正在运行
2. 查看终端/命令行窗口，确认服务已启动
3. 如果服务器停止了，重新启动：
   ```bash
   cd examples/vanilla  # 或其他示例目录
   pnpm run dev
   ```

### 问题 2：页面显示但样式错乱

**症状**：页面内容都在，但布局很乱，没有颜色和样式

**解决方案**：

1. 刷新页面（Ctrl + R 或 F5）
2. 检查网络面板（F12 -> Network）
3. 查看是否有 CSS 文件加载失败（红色状态）
4. 检查 Luckysheet CSS 是否加载成功

### 问题 3：Luckysheet 未定义

**症状**：
```
Uncaught ReferenceError: luckysheet is not defined
```

**解决方案**：

1. 检查网络连接（Luckysheet 从 CDN 加载）
2. 尝试刷新页面
3. 检查是否被广告拦截器阻止
4. 查看 Network 面板确认 CDN 资源是否加载成功

### 问题 4：Excel 文件上传后无反应

**症状**：文件选择后没有任何变化，状态栏仍显示"等待加载文件..."

**可能原因及解决方案**：

#### 原因 A：代码错误
- 打开控制台查看错误信息
- 如果有 `Cannot find module 'xlsx'` 错误：
  ```bash
  cd packages/core
  pnpm install xlsx
  ```

#### 原因 B：数据转换失败
- 控制台可能显示数据转换相关错误
- 尝试使用更简单的 Excel 文件
- 检查文件格式是否正确

#### 原因 C：Luckysheet 初始化失败
- 确认 `window.luckysheet` 存在
- 检查容器 ID 是否正确
- 查看 Luckysheet 相关错误

### 问题 5：部分功能无法使用

**症状**：页面正常，但某些功能（如导出、搜索）不工作

**说明**：这是预期的，因为：

1. **导出功能** - 需要先成功加载 Excel 文件
2. **搜索功能** - 需要有数据才能搜索
3. **编辑功能** - 依赖 Luckysheet 正确初始化

## 📋 测试检查清单

请完成以下检查并打勾：

### Vanilla JS (localhost:3000)
- [ ] 页面正常加载
- [ ] 所有按钮和输入框显示正常
- [ ] 状态栏显示："等待加载文件..."
- [ ] 控制台显示："✅ 查看器初始化成功"
- [ ] `window.luckysheet` 存在
- [ ] 可以选择 Excel 文件
- [ ] Excel 文件可以正常显示（如果测试了）

### Vue 3 (localhost:3001)
- [ ] 页面正常加载
- [ ] 所有按钮和输入框显示正常
- [ ] 状态栏显示："等待加载文件..."
- [ ] 控制台无严重错误
- [ ] 可以选择 Excel 文件
- [ ] Excel 文件可以正常显示（如果测试了）

### React (localhost:3002)
- [ ] 页面正常加载
- [ ] 所有按钮和输入框显示正常
- [ ] 状态栏显示："等待加载文件..."
- [ ] 控制台无严重错误
- [ ] 可以选择 Excel 文件
- [ ] Excel 文件可以正常显示（如果测试了）

### Lit (localhost:3003)
- [ ] 页面正常加载
- [ ] 所有按钮和输入框显示正常
- [ ] 状态栏显示："等待加载文件..."
- [ ] 控制台无严重错误
- [ ] 可以选择 Excel 文件
- [ ] Excel 文件可以正常显示（如果测试了）

## 📝 记录测试结果

### 成功情况

如果一切正常，请记录：

```
✅ 测试通过！

测试的示例：__________
测试的文件：__________
Excel 内容显示：正常 / 不正常
发现的问题：


```

### 问题情况

如果遇到问题，请记录：

```
❌ 发现问题

示例项目：__________
问题描述：


控制台错误：


截图保存位置：


```

## 🎯 下一步

### 如果测试成功 ✅

恭喜！项目基本功能正常。您可以：

1. 测试其他示例项目
2. 尝试更复杂的 Excel 文件
3. 测试编辑、导出等功能
4. 查看详细文档了解更多功能

### 如果遇到问题 ❌

不要担心，这是开发过程的一部分：

1. **记录详细的错误信息**（控制台截图）
2. **查看以下文档**：
   - `EXAMPLES_USAGE.md` - 示例使用说明
   - `BROWSER_TEST_CHECKLIST.md` - 详细测试清单
   - `FINAL_TEST_REPORT.md` - 测试报告
3. **检查已知问题**
4. **必要时修复核心代码**

## 📚 相关文档

- **EXAMPLES_USAGE.md** - 详细的示例使用说明
- **BROWSER_TEST_CHECKLIST.md** - 完整的浏览器测试清单
- **FINAL_TEST_REPORT.md** - 最终测试报告
- **VITE_SETUP.md** - Vite 配置指南
- **BUILD_TEST_GUIDE.md** - 打包测试指南
- **docs/GUIDE.md** - 完整使用指南
- **docs/API.md** - API 文档

## 💡 提示

1. **建议使用 Chrome 或 Edge 浏览器进行测试**
2. **保持开发者工具打开以便查看错误**
3. **从最简单的 Excel 文件开始测试**
4. **如果一个示例有问题，尝试其他示例**
5. **记录所有错误信息，有助于问题排查**

---

**祝测试顺利！** 🎉

如果所有示例都能正常显示页面和基本 UI，说明配置是成功的。
即使 Excel 渲染有问题，也可以通过调试逐步解决。

**开始测试吧！** → 打开 http://localhost:3000

